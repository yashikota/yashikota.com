---
title: 独自ドメインのメールをサーバーレスで運用する方法
pubDate: 2023-01-21
updDate: 
isUnlisted: false
category: tech
tags: ["雑記"]
---

世の中には無料で使えるメールサービスなんて沢山有るけどあえて独自ドメインのメールを運用したい人向けの記事です。  
今回はこの独自ドメインのメールを自分でサーバーを用意せず(サーバーレス)に**無料**で送受信させてみたいと思います。  

## 送信

GmailのSMTPサーバーを使用します。  

まずはアプリパスワードというものを取得します(※2要素認証必須)。  
[Googleアカウントのセキュリティ](https://myaccount.google.com/security)
のGoogle へのログインからアプリパスワードをクリックして生成して保管してください。  

次にGmailを開き、右上の歯車からすべての設定を表示で
[アカウントとインポート](https://mail.google.com/mail/u/0/?tab=rm&ogbl#settings/accounts)
から他のメール アドレスを追加をクリックするとポップアップが出現するので適当な名前と独自ドメインのメールアドレスを入力。  
その後SMTP サーバーに```smtp.gmail.com```を、ポートに```587```を、ユーザー名にGmailのアドレス(```example@gmail.com```みたいな)を、パスワードにアプリパスワードをそれぞれ入力後、アカウントを追加をクリックしてください。  
認証用のメールが来るので認証すると使用可能になります！  

## 受信

受信は
[Cloudflare Email Routing](https://www.cloudflare.com/products/email-routing/)
というCloudflareのサービスを使用します。  
このサービスは名前の通りメールを転送してくれるものです。  
例えば```mail@example.com```のアドレスに対して送信されたメールを```example@gmail.com```に転送するような感じです。  

設定方法は
[公式ドキュメント](https://developers.cloudflare.com/email-routing)
を参考にしてください。  

## メリット

この方式の最大のメリットはなんといっても**無料**で運用できることです。  
普通は自分でメールサーバを建てたりして、サーバー代が少なからずかかるので。  
またGmailのUIが使えたり、複雑なサーバーの設定の必要がないのもメリットかなと思います。

## デメリット

GoogleとCloudflareのサービスを使用しているのでどちらかのサービスに障害発生またはサービスが終了すると使えなくなってしまいます。  
またメールの保存先もGmailのサーバーになるので、Googleアカウントが停止されたりしたらメールが全て失われてしまうので、こまめなバックアップが必要かなと思います。  
